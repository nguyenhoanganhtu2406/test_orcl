/*
Sample data for the Introduction to Oracle SQL course
*/

/*
DROP TABLE ChiTietHD;
DROP TABLE HoaDon;
DROP TABLE TrangThai;
DROP TABLE NhanVien;
DROP TABLE PhanQuyen;
DROP TABLE KhachHang;
DROP TABLE HangHoa;
DROP TABLE NhaCungCap;
DROP TABLE Loai;
*/

CREATE TABLE Loai(
  MaLoai VARCHAR2(10) NOT NULL,
  GioiTinh NUMBER(1) NOT NULL,
  TenLoai NVARCHAR2(30) NOT NULL,
  CONSTRAINT pk_loai PRIMARY KEY (MaLoai)
);


CREATE TABLE NhaCungCap(
  MaNCC VARCHAR2(10) NOT NULL,
  TenCongTy NVARCHAR2(50) NOT NULL,
  Email VARCHAR2(50) NOT NULL,
  DienThoai VARCHAR2(24) NOT NULL,
  DiaChi NVARCHAR2(60) NOT NULL,
  CONSTRAINT pk_ncc PRIMARY KEY (MaNCC)
);


CREATE TABLE HangHoa (
  MaHH NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY,
  TenHH NVARCHAR2(60) NOT NULL,
  MaLoai VARCHAR2(10) NOT NULL,
  Hinh NVARCHAR2(60),
  DonGia FLOAT NOT NULL,
  GiamGia FLOAT NOT NULL,
  MoTa NVARCHAR2(1000),
  MaNCC VARCHAR2(10) NOT NULL,
  CONSTRAINT pk_hh PRIMARY KEY (MaHH),
  CONSTRAINT fk_hh_loai FOREIGN KEY (MaLoai) REFERENCES Loai(MaLoai),
  CONSTRAINT fk_hh_ncc FOREIGN KEY (MaNCC) REFERENCES NhaCungCap(MaNCC)
);


CREATE TABLE KhachHang (
  MaKH NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY,
  MatKhau VARCHAR2(50) NOT NULL,
  HoTen NVARCHAR2(50) NOT NULL,
  DiaChi NVARCHAR2(60),
  DienThoai VARCHAR2(24),
  Email VARCHAR2(50) NOT NULL,
  Hinh VARCHAR2(50),
  TaiKhoan VARCHAR2(30),
  GioiTinh NVARCHAR2(50),
  NgaySinh DATE,
  TrangThaiHD NUMBER(1),
  CONSTRAINT pk_kh PRIMARY KEY (MaKH)
);

CREATE TABLE PhanQuyen(
  MaPQ NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY,
  Them NUMBER(1) NOT NULL,
  Sua NUMBER(1) NOT NULL,
  Xoa NUMBER(1) NOT NULL,
  Xem NUMBER(1) NOT NULL,
  CONSTRAINT pk_pq PRIMARY KEY (MaPQ)
);


CREATE TABLE NhanVien (
  MaNV NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY,
  HoTen NVARCHAR2(50) NOT NULL,
  Email VARCHAR2(50) NOT NULL,
  MatKhau VARCHAR2(50) NOT NULL,
  MaPQ NUMBER(10) NOT NULL,
  TrangThaiHD NUMBER(1),
  CONSTRAINT pk_nv PRIMARY KEY (MaNV),
  CONSTRAINT fk_nv_pq FOREIGN KEY (MaPQ) REFERENCES PhanQuyen(MaPQ)
);


CREATE TABLE TrangThai(
  MaTrangThai NUMBER(10) NOT NULL,
  TenTrangThai NVARCHAR2(30) NOT NULL,
  CONSTRAINT pk_tt PRIMARY KEY (MaTrangThai)
);


CREATE TABLE HoaDon (
  MaHD NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY,
  MaKH NUMBER(10) NOT NULL,
  NgayDat DATE NOT NULL,
  NgayGiao DATE,
  HoTen NVARCHAR2(50),
  DiaChi NVARCHAR2(60) NOT NULL,
  SDT_nguoinhan VARCHAR2(20),
  GhiChu NVARCHAR2(50),
  PhiVanChuyen NUMBER(9) NOT NULL,
  MaTrangThai NUMBER(10),
  MaNV NUMBER(10),
  TongTienHang FLOAT,
  TongThucThu FLOAT,
  CONSTRAINT pk_hd PRIMARY KEY (MaHD),
  CONSTRAINT fk_hd_kh FOREIGN KEY (MaKH) REFERENCES KhachHang(MaKH),
  CONSTRAINT fk_hd_tt FOREIGN KEY (MaTrangThai) REFERENCES TrangThai(MaTrangThai)
);


CREATE TABLE ChiTietHD(
  MaCT NUMBER(10) GENERATED BY DEFAULT ON NULL AS IDENTITY,
  MaHD NUMBER(10) NOT NULL,
  MaHH NUMBER(10) NOT NULL,
  DonGia NUMBER(10,1) NOT NULL,
  GiamGia NUMBER(10,1) NULL,
  SoLuong NUMBER(10) NOT NULL,
  KichCo VARCHAR2(5),
  CONSTRAINT pk_cthd PRIMARY KEY (MaCT),
  CONSTRAINT fk_cthd_hd FOREIGN KEY (MaHD) REFERENCES HoaDon(MaHD),
  CONSTRAINT fk_cthd_hh FOREIGN KEY (MaHH) REFERENCES HangHoa(MaHH)
);


INSERT INTO Loai (MALOAI, TENLOAI, GIOITINH) VALUES ('ESAO006', N'ÁO SƠ MI TAY DÀI', 1);
INSERT INTO Loai (MALOAI, TENLOAI, GIOITINH) VALUES ('ESAO007', N'ÁO SƠ MI NGẮN TAY', 0);
DELETE FROM Loai WHERE MALOAI = 'ESAO007'; 
SELECT * FROM LOAI;
set NLS_LANG=AMERICAN_AMERICA.UTF8;

COMMIT;
/*
Sample data
*/




/*
SELECT * FROM employee;
SELECT * FROM department;
SELECT * FROM customer;
SELECT * FROM product;
SELECT * FROM customer_order;
*/



